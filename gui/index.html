<!DOCTYPE HTML>
<html>
  <head>
    <title>RangeRovr</title>
    <link rel="stylesheet" type="text/css" href="style.css"/>
		<meta charset="utf-8" />

		<script type="text/javascript" src="http://cdn.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
		<script type="text/javascript" src="http://cdn.robotwebtools.org/roslibjs/current/roslib.min.js"></script>

    <script type="text/javascript" type="text/javascript">
			  // Connecting to ROS
  			// -----------------

				var ros = new ROSLIB.Ros({
					url : 'ws://localhost:9090'
				});

			  ros.on('connection', function() {
    			console.log('Connected to websocket server.');
  			});

 		 		ros.on('error', function(error) {
    			console.log('Error connecting to websocket server: ', error);
  			});

  			ros.on('close', function() {
    			console.log('Connection to websocket server closed.');
  			});

  			// Subscribing to a Topic
  			// ----------------------

  			var stationLocationPublisher = new ROSLIB.Topic({
    			ros : ros,
    			name : '/choose_station',
    			messageType : 'std_msgs/Int8'
 				});

	  		//dispenseListener.subscribe(function(message) {
    		//	console.log('Received message on ' + dispenseListener.name + ': ' + message.data);
  			//});
		    window.onload = function() {
        	var stationButtons = document.getElementsByClassName("stationButton");

        	for (var i = 0; i < stationButtons.length; i++) {
          	stationButtons[i].addEventListener('click', function() {
            	toMainPage(this);
          	}, false);
        	}
      }

      var toMainPage = function(button) {
        // TODO: use button.getAttribute('location') to save location;
				var stationNum = button.getAttribute('value');
				var stationLocationMessage = new ROSLIB.Message({
					data: parseInt(stationNum)
				});

				stationLocationPublisher.publish(stationLocationMessage);
				console.log(stationLocationPublisher);

        setTimeout(function() {
					location.href = "../gui/main.html?station=" + stationNum + "&basket=1";
				}, 100);
      };
    </script>
  </head>
    
  <body>
    <div id="temp">
      <div>
        Select a station:
      </div>
      <button class="stationButton" type="button" value=1 location='(1, 2, 3)'>Station 1</button>
      <button class="stationButton" type="button" value=2 location='(4, 5, 6)'>Station 2</button>
      <button class="stationButton" type="button" value=3 location='(7, 8, 9)'>Station 3</button>
    </div>
  </body>
</html>


